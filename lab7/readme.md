# 微處理機系統與介面技術 - LAB 7

## 實驗簡介
本次實驗利用 NUC140 微控制器實現 GPIO 中斷與看門狗計時器 (Watchdog Timer, WDT) 的功能。透過按鍵中斷切換系統狀態 (Safe/Alarm)，當系統處於異常狀態時，WDT 會觸發系統復位以重置異常狀態，確保系統的穩定性。

## 實驗器材
- **NUC140 V2.0 開發板**
- **UART to USB 模組**（PL2303HXA 或 CH340G）
- **Putty 軟體**（用於終端模擬）

## 實驗功能
### 基本功能
- 使用 GPIO 中斷觸發按鍵事件，切換系統狀態。
- 使用 WDT 監控系統，當系統處於異常狀態時，觸發中斷或重置系統。
- 在 Putty 中顯示系統狀態 (Safe/Alarm)。

### 加分功能
- 實現按鍵去抖動功能，避免按鍵彈跳造成多次中斷。
- 配置 WDT 的超時和重置延遲參數，實現高可靠性的監控。

## 實驗步驟
1. **硬體接線**：
   - 使用 PA3 作為按鍵中斷腳位，設定為下降緣觸發。
   - 將 PA2 接地，PA3 預設拉高。

2. **軟體設置**：
   - 啟用 GPIO 中斷並設定除抖功能。
   - 啟用 WDT，設定超時參數為 2^14 個時鐘週期，重置延遲為 1024 個時鐘週期。

3. **程式運行**：
   - 按下按鍵觸發 GPIO 中斷切換系統狀態。
   - 當系統處於 Safe 狀態時，WDT 會持續重置計數器；若系統處於 Alarm 狀態，WDT 將觸發系統復位。

## 系統架構
### 程式結構
- **main.c**：
  - `SYS_Init`：初始化系統時鐘和多功能腳位。
  - `UART0_Init`：初始化 UART，設置波特率為 115200。
  - `OpenKeyPad`：配置按鍵 GPIO 腳位為 Quasi 模式。
  - `GPAB_IRQHandler`：處理 GPIO 中斷，切換系統狀態。
  - `WDT_IRQHandler`：處理 WDT 中斷，檢查系統狀態並重置計數器。
  - `main`：初始化系統並進行狀態監控。

### GPIO 中斷
- **觸發模式**：下降緣觸發。
- **去抖動配置**：
  - 使用 LIRC (Low Internal RC Oscillator) 作為除抖時鐘來源。
  - 設定除抖時鐘間隔為 1024 個週期。

### Watchdog Timer
- **超時參數**：2^14 個時鐘週期。
- **重置延遲**：1024 個時鐘週期。
- **功能**：
  - 當系統為 Safe 狀態時，重置計數器 (餵狗)。
  - 當系統為 Alarm 狀態且超時時，觸發系統復位。

## 成果展示
- 按下按鍵切換系統狀態，Putty 終端顯示：
